{% extends "base.html" %}

{% block content %}
  <section class="hero-card">
    <div>
      <p class="eyebrow">Weekly review</p>
      <h1 class="hero-title">Your week at a glance</h1>
      <p class="hero-subtitle">Summary from {{ start_date }} to {{ end_date }}.</p>
    </div>
  </section>

  <section class="section-grid">
    <div class="section-card">
      <h2 class="section-title">Planning outcomes</h2>
      <div class="list-stack">
        <div class="list-item">
          <span>Done</span>
          <strong>{{ plan_stat_map.get("done", 0) }}</strong>
        </div>
        <div class="list-item">
          <span>Pending</span>
          <strong>{{ plan_stat_map.get("pending", 0) }}</strong>
        </div>
        <div class="list-item">
          <span>Missed</span>
          <strong class="text-danger">{{ plan_stat_map.get("missed", 0) }}</strong>
        </div>
      </div>
    </div>

    <div class="section-card">
      <h2 class="section-title">Spending by day</h2>
      <div class="list-stack">
        {% for day in spending_by_day %}
          <div class="list-item">
            <span>{{ day["spend_date"] }}</span>
            <strong>£{{ "%.2f"|format(day["total"]) }}</strong>
          </div>
        {% else %}
          <p class="empty-state">No spending logged this week.</p>
        {% endfor %}
      </div>
    </div>

    <div class="section-card">
      <h2 class="section-title">Spending by category</h2>
      <div class="list-stack">
        {% for item in spending_by_category %}
          <div class="list-item">
            <span>{{ item["category"] }}</span>
            <strong>£{{ "%.2f"|format(item["total"]) }}</strong>
          </div>
        {% else %}
          <p class="empty-state">No category totals yet.</p>
        {% endfor %}
      </div>
    </div>

    <div class="section-card">
      <h2 class="section-title">Habits logged</h2>
      <div class="list-stack">
        {% for habit in habit_counts %}
          <div class="list-item">
            <span>{{ habit["name"] }}</span>
            <strong>{{ habit["total"] or 0 }}</strong>
          </div>
        {% else %}
          <p class="empty-state">No habit logs yet.</p>
        {% endfor %}
      </div>
    </div>

    <div class="section-card">
      <h2 class="section-title">Routine completions</h2>
      <div class="list-stack">
        {% for routine in routine_completions %}
          <div class="list-item">
            <span>{{ routine["name"] }}</span>
            <strong>{{ routine["total"] or 0 }}</strong>
          </div>
        {% else %}
          <p class="empty-state">No routine logs yet.</p>
        {% endfor %}
      </div>
    </div>
  </section>
{% endblock %}
